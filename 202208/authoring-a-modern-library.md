# ç¼–å†™ç°ä»£ JavaScript åº“

ç°ä»£å¼€å‘çš„è¿‡ç¨‹ï¼Œå¼€å‘è€…å¸¸å¸¸ä¼šä½¿ç”¨åˆ°å„ç§å„æ ·çš„åº“ã€‚åˆ°ç›®å‰ä¸ºæ­¢ï¼Œnpm ä¸Šçš„åŒ…çš„æ•°é‡å·²ç»è¶…è¿‡äº† 200 ä¸‡ã€‚è€Œä¸”è¿™ä¸ªæ•°å­—è¿˜åœ¨ä¸æ–­çš„å¢åŠ ã€‚é‚£ä¹ˆï¼Œåº“å¯¹äºæˆ‘ä»¬å¼€å‘è€…æ¥è¯´æœ‰ä»€ä¹ˆæ„ä¹‰å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚å½“å¼€å‘è€…å‘ç°è‡ªå·±åœ¨ä¸åŒçš„é¡¹ç›®ä¸­éœ€è¦ç¼–å†™ç±»ä¼¼çš„ä»£ç æ—¶ï¼Œä»–ä»¬å¯ä»¥ç›´æ¥å°†ä¸€ä¸ªé¡¹ç›®çš„ä»£ç å¤åˆ¶ç²˜è´´åˆ°å¦ä¸€ä¸ªé¡¹ç›®ä¸­å»ã€‚ä½†æ˜¯è¿™ç§åšæ³•çš„ç¼ºç‚¹æ˜¯å¾ˆæ˜æ˜¾çš„ã€‚ä¸€æ—¦è¿™æ®µä»£ç ä¸­æœ‰ä»»ä½•æ”¹åŠ¨ï¼Œå¼€å‘è€…éœ€è¦æ‰‹åŠ¨å°†è¿™ä¸ªæ”¹åŠ¨åŒæ­¥åˆ°æ‰€æœ‰é¡¹ç›®ä¸­ã€‚è¿™æ— ç–‘æ˜¯éå¸¸è€—è´¹ç²¾åŠ›çš„è¡Œä¸ºï¼Œè€Œä¸”å¾ˆéš¾ä¿è¯ä¸ä¼šæœ‰é¡¹ç›®è¢«é—æ¼ã€‚äºæ˜¯ï¼Œä¸ºäº†é¿å…è¿™ä¸ªç¹ççš„å·¥ä½œï¼Œå¼€å‘è€…ä¼šå°†è¿™äº›å…¬å…±çš„åŠŸèƒ½ä»£ç æ®µæå–å‡ºæ¥ï¼Œç»„æˆä¸€ä¸ªâ€œå·¥å…·ç®±â€ã€‚ä¹‹åï¼Œå¼€å‘è€…éœ€è¦ä½¿ç”¨æŸç§å·¥å…·æ—¶ï¼Œåªéœ€è¦ä»è¿™ä¸ªâ€œå·¥å…·ç®±â€ä¸­å–ã€‚è€Œè¿™ä¸ªâ€œå·¥å…·ç®±â€ä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„åº“ã€‚åœ¨å®Œæˆå¯¹åº“çš„ç¼–å†™ä¹‹åï¼Œä¸‹ä¸€æ­¥è¦åšçš„å°±æ˜¯å°†åº“å‘å¸ƒå‡ºå»ã€‚è¿™ä¸€æ­¥éª¤å¹¶ä¸ç®€å•ï¼Œå› ä¸ºæœ‰å¾ˆå¤šæ–¹é¢éœ€è¦æˆ‘ä»¬è€ƒè™‘ã€‚ä¸è¿‡è¿™æ¬¡ï¼Œæˆ‘ä»¬ä¸»è¦è®¨è®ºçš„æ˜¯è¿™ä¸ªåº“æ”¯æŒå“ªäº›æ¨¡å—ç³»ç»Ÿã€‚

## JavaScript çš„æ¨¡å—ç³»ç»Ÿ

å‰ç«¯æ€»æ˜¯åœ¨è¿…é€Ÿçš„å‘å±•å’Œå˜åŒ–ä¹‹ä¸­ã€‚ä¼¼ä¹åœ¨å‰ç«¯é¢†åŸŸï¼Œå”¯ä¸€ä¸”æ­£ç¡®çš„åšæ³•å¾€å¾€æ˜¯ä¸å­˜åœ¨çš„ã€‚å³ä½¿æ˜¯å½“ä¸‹æœ€æµè¡Œçš„åº“æˆ–è€…æœ€æ¨å´‡çš„è§£å†³æ–¹å¼ï¼Œå¾ˆå¯èƒ½å·²ç»èµ°åœ¨æˆä¸ºæ˜æ—¥é»„èŠ±çš„é“è·¯ä¸Šäº†ã€‚å½“åˆï¼ŒGrunt æ–¹å…´æœªè‰¾ï¼Œå´åœ¨ä¸ä¹…ä¹‹åè¢« gulp æŠ¢èµ°é£å¤´ã€‚è€Œæœ€åï¼Œè¿™ä¸¤è€…éƒ½å·²ç»é²œæœ‰äººé—®æ´¥äº†ã€‚è€Œåœ¨ JavaScript çš„æ¨¡å—ç³»ç»Ÿæ–¹é¢ï¼Œä¹Ÿæ˜¯å¦‚æ­¤ã€‚

### iife

æœ€è¿‘æ‰æ¥è§¦å‰ç«¯å¼€å‘çš„åŒå­¦å¯èƒ½ä¼šè®¤ä¸º JavaScript æœ‰æ¨¡å—ç³»ç»Ÿæ˜¯ç†æ‰€å½“ç„¶çš„ã€‚çš„ç¡®ï¼Œæ¨¡å—ç³»ç»Ÿå·²ç»æˆä¸ºæˆ‘ä»¬å¼€å‘æ—¶ç¦»ä¸å¼€çš„ä¸€éƒ¨åˆ†ã€‚ç°åœ¨çš„å‰ç«¯å¼€å‘è€…åœ¨ä¸€ä¸ªæ–°å»ºçš„ JavaScript æ–‡æ¡£ä¸­è¾“å…¥çš„ç¬¬ä¸€ä¸ªè¯å¾ˆå¯èƒ½å°±æ˜¯`import`ã€‚ä½†æ˜¯ï¼Œåœ¨æˆ‘åˆšåˆšæ¥è§¦å‰ç«¯å¼€å‘çš„æ—¶å€™ï¼Œæƒ…å†µå¤§ä¸ä¸€æ ·ã€‚é‚£æ˜¯ä¸€ä¸ªå¤§å®¶è¿˜ä¼šäº‰è®ºåº”è¯¥å­¦ä¹ åŸç”Ÿ JavaScript è¿˜æ˜¯ jQuery çš„å¹´ä»£ã€‚è€Œåœ¨é‚£ä¸ª ES æ¨¡å—æ ‡å‡†è¿˜æ²¡æœ‰è¯ç”Ÿçš„â€œåŸå§‹â€çš„æ—¶ä»£ï¼Œåº“ä½œè€…ä»¬ä¼šä»¥ä»€ä¹ˆæ ·çš„å½¢å¼å‘å¸ƒä»–ä»¬åˆšå®Œæˆçš„åº“å‘¢ï¼Ÿ

é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å½“æ—¶çš„å‰ç«¯å¼€å‘è€…é€šå¸¸æ˜¯å¦‚ä½•ä½¿ç”¨åº“çš„ã€‚å‡å¦‚å¼€å‘è€…æƒ³è¦åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ jQueryï¼Œé‚£ä¹ˆä»–ä¼šæ‰“å¼€æµè§ˆå™¨ï¼Œè¿›å…¥ jQuery çš„å®˜ç½‘ï¼Œç‚¹å‡»ä¸‹è½½æœ€æ–°ç‰ˆæœ¬çš„ jQueryï¼Œç„¶åå°†ä¸‹è½½åˆ°çš„æ–‡ä»¶ç§»åŠ¨åˆ°é¡¹ç›®çš„æŸä¸ªç›®å½•ä¸‹ã€‚æ¥ä¸‹æ¥ï¼Œä»–åœ¨`index.html`ä¸­æ’å…¥äº†ä¸€ä¸ªæ–°`script`æ ‡ç­¾ï¼Œå°†å…¶`src`è®¾ç½®ä¸ºåˆšåˆšç§»å…¥çš„ jQuery æ–‡ä»¶çš„è·¯å¾„ã€‚äºæ˜¯ï¼Œä»–å°±å¯ä»¥åœ¨è‡ªå·±çš„ä»£ç ä¸­ç›´æ¥é€šè¿‡`$`ä½¿ç”¨ jQuery æä¾›çš„ä¸°å¯Œçš„åŠŸèƒ½äº†ã€‚HmmğŸ¤”ï¸ï¼Œè¿™ç¡®å®ä¸å¦‚æ‰§è¡Œä¸€æ¬¡`npm install`æ¥çš„æ–¹ä¾¿å•Šã€‚Anywayï¼Œä¸ºäº†èƒ½å¤Ÿè®©ç”¨æˆ·é€šè¿‡è¿™ç§æ–¹å¼ä½¿ç”¨æˆ‘ä»¬æœ€æ–°æœ€æ½®çš„åº“ï¼Œæˆ‘ä»¬åº”è¯¥æ€ä¹ˆåšï¼Ÿ

```js
var $ = (function (exports) {
  "use strict";

  var add = function (a, b) {
    return a + b;
  };

  exports.add = add;

  Object.defineProperty(exports, "__esModule", { value: true });

  return exports;
})({});
```

ä»¥ä¸Šä»£ç æ˜¯`format`è¢«è®¾ç½®ä¸º`iife`æ—¶ï¼Œ`rollup`ç”Ÿæˆçš„ç›®æ ‡ä»£ç ã€‚

æ‰€è°“ iifeï¼Œå°±æ˜¯ Immediately Invoked Function Expressionï¼Œå³â€œç«‹å³æ‰§è¡Œå‡½æ•°è¡¨è¾¾å¼â€çš„ç¼©å†™ã€‚iife é€šå¸¸æ˜¯`(function(){})()`å½¢å¼ã€‚æ—©æœŸçš„åº“å¾ˆå¤šéƒ½æ˜¯é€šè¿‡è¿™ç§æ–¹å¼æ¥æ¨¡æ‹Ÿæ¨¡å—ï¼Œå› æ­¤è¿™ç§æ¨¡å¼ä¹Ÿè¢«ç§°ä½œæ˜¯ module patternã€‚è¿™æ ·ä¸€æ¥ï¼Œå‡½æ•°ä¸­çš„å˜é‡å°±ä¸ä¼šå¯¹å…¨å±€ä½œç”¨åŸŸä¸­çš„å˜é‡äº§ç”Ÿå†²çªï¼Œä¹Ÿå°±æ˜¯é¿å…äº†å¯¹å…¨å±€å‘½åç©ºé—´çš„æ±¡æŸ“ã€‚ä¸è¿‡åœ¨ç°åœ¨ï¼Œè¿™ç§æŠ€æœ¯è¢«ä½¿ç”¨çš„è¶Šæ¥è¶Šå°‘äº†ã€‚å› ä¸ºæˆ‘ä»¬ç°åœ¨é€šå¸¸æ˜¯åœ¨æ¨¡å—ä½œç”¨åŸŸä¸­åˆ›å»ºå˜é‡ï¼Œè€Œå³ä½¿æ˜¯æ¨¡å—ä½œç”¨åŸŸä¸­çš„`var`å˜é‡ä¹Ÿä¸ä¼šæ±¡æŸ“å…¨å±€å‘½åç©ºé—´ã€‚å¯æƒœçš„æ˜¯ï¼Œè¿™ç§æ–¹å¼ç®—ä¸ä¸Šæ˜¯å®Œç¾ã€‚

- **ä¸å­˜åœ¨ä¾èµ–ç®¡ç†ï¼ˆdependency managementï¼‰**ï¼šå¦‚æœè¿™ä¸ªåº“ä¾èµ–å…¶ä»–åº“ï¼Œé‚£ä¹ˆç”¨æˆ·éœ€è¦åŒæ—¶å¼•å…¥å…¶ä¾èµ–åº“ï¼Œå¹¶ä¸”è¦ç¡®ä¿`script`æ ‡ç­¾çš„é¡ºåºæ˜¯æ­£ç¡®çš„ã€‚æ¯”å¦‚ï¼Œåœ¨å¼•å…¥ bootstrap æ—¶ï¼Œå°±å¿…é¡»å…ˆå¼•å…¥ jQueryã€‚å½“é¡¹ç›®æœ‰å¤§é‡ä¾èµ–æ—¶ï¼Œå¯¹è¿™äº›ä¾èµ–çš„ç®¡ç†ä¹Ÿä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜ã€‚
- **å‘½åå†²çª**ï¼šè™½ç„¶ iife å·²ç»å°½é‡åœ¨é¿å…ï¼Œä½†æ˜¯ä»ç„¶è¿˜æ˜¯åˆ›å»ºäº†ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œå­˜åœ¨ä¸ç”¨æˆ·ä»£ç äº§ç”Ÿå†²çªçš„å¯èƒ½æ€§ã€‚

### CommonJS

åœ¨ 2009 å¹´ï¼Œç¤¾åŒºå†…å‡ºç°äº†å°† JavaScript å¼•å…¥æœåŠ¡å™¨ç«¯çš„è®¨è®ºã€‚äºæ˜¯ï¼ŒKevin Dangoor åˆ›å»ºäº† ServerJS é¡¹ç›®ã€‚

> What Iâ€™m describing here is not a technical problem. Itâ€™s a matter of people getting together and making a decision to step forward and start building up something bigger and cooler together.
>
> â€”â€‰Kevin Dangoor

ååœ¨ 09 å¹´çš„å…«æœˆï¼Œè¿™ä¸ªé¡¹ç›®è¢«é‡å‘½åä¸º CommonJSï¼Œä»¥è¡¨ç¤ºå…¶ API è¢«åº”ç”¨äºæ›´å¤šé¢†åŸŸçš„å¯èƒ½æ€§ã€‚CommonJS æ˜¯ä¸€ä¸ªæ ‡å‡†åŒ–ç»„ç»‡ã€‚æ­£å¦‚ ECMA ç»„ç»‡åˆ¶å®šäº† ECMAScript çš„è¯­è¨€è§„èŒƒã€W3C ç»„ç»‡è§„èŒƒäº†åŒ…å« DOM åœ¨å†…çš„ JavaScript web APIï¼ŒCommonJS çš„ç›®æ ‡æ˜¯ä¸ºæœåŠ¡å™¨ç«¯ã€æ¡Œé¢ç«¯ç­‰éæµè§ˆå™¨ç¯å¢ƒä¸­çš„ JavaScript åˆ›å»ºä¸€ä¸ªé€šè¡Œçš„å‡†åˆ™ã€‚

æœåŠ¡å™¨ç«¯åº”ç”¨æ²¡æœ‰ HTML é¡µé¢ä¹Ÿæ²¡æœ‰ script æ ‡ç­¾ï¼Œå› æ­¤ä¸€ä¸ªçœŸæ­£çš„æ¨¡å—ç³»ç»Ÿæ˜¯ä¸å¯æˆ–ç¼ºçš„ã€‚CommonJS ä¹Ÿç¡®å®ä¸º JavaScript å¢åŠ äº† modules ç›¸å…³çš„ APIã€‚è¿™ä¸ªæ¨¡å—å½¢å¼å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œå°¤å…¶æ˜¯åº”ç”¨åœ¨ä½¿ç”¨ NodeJS è¿›è¡ŒæœåŠ¡å™¨ç«¯å¼€å‘ä¸­ã€‚ç›¸ä¿¡å¤§å®¶å¯¹å…¶å·²ç»éå¸¸ç†Ÿæ‚‰äº†ï¼Œå› æ­¤å¯¹å…¶è¯­æ³•ä»¥åŠå¦‚ä½•ä½¿ç”¨å°±ä¸å†è¿›è¡Œè¿‡å¤šèµ˜è¿°ã€‚

```js
"use strict";

Object.defineProperty(exports, "__esModule", { value: true });

var add = function (a, b) {
  return a + b;
};

exports.add = add;
```

ä»¥ä¸Šä»£ç æ˜¯`format`è¢«è®¾ç½®ä¸º`cjs`æ—¶ï¼Œ`rollup`ç”Ÿæˆçš„ç›®æ ‡ä»£ç ã€‚

äºæ˜¯ï¼Œåœ¨ä½¿ç”¨æˆ‘ä»¬çš„åº“æ—¶ï¼Œç”¨æˆ·åªéœ€è¦å®‰è£…å®ƒï¼Œä½¿ç”¨`require("my-awesome-library")`å°†æ¨¡å—å¼•å…¥ä»£ç ä¸­ã€‚æ¯ä¸ªæ¨¡å—çš„ä¾èµ–æ¸…æ™°å¯è§ï¼Œä»¤äººåŒæ¶çš„å…¨å±€å˜é‡å´æ¶ˆå¤±æ— è¸ªã€‚Ahaï¼iife å­˜åœ¨çš„ä¸¤ä¸ªé—®é¢˜éƒ½å·²ç»è¢«è§£å†³ã€‚

### Asynchronous Module Definitionï¼ˆAMDï¼‰

CommonJS æ¨¡å—ä¹Ÿå­˜åœ¨ä¸€ä¸ªä¸æ˜¯é—®é¢˜çš„é—®é¢˜ â€”â€”â€”â€” æ¨¡å—éƒ½æ˜¯åŒæ­¥çš„ã€‚è¿™æ„å‘³ç€å½“æ‰§è¡Œåˆ°`var foo = require('some-module')`æ—¶ï¼Œhost ä¼šæš‚åœå½“å‰ä»£ç çš„æ‰§è¡Œï¼Œç›´åˆ°è¿è¡Œå®Œæ¨¡å—ä¹‹ä¸­çš„ä»£ç ï¼Œå†å°†æ¨¡å— export çš„å€¼èµ‹ç»™`foo`å˜é‡ã€‚åœ¨æœåŠ¡å™¨ç«¯ï¼Œè¿™æ ·çš„å¤„ç†æ˜¯èƒ½å¤Ÿè¢«æ¥å—çš„ã€‚ä½†åœ¨æµè§ˆå™¨ç«¯ï¼Œè¿™ä¼šä¸ºç”¨æˆ·å¸¦æ¥ä¸€ä¸ªä¸å¥½çš„ä½“éªŒã€‚äºæ˜¯ï¼ŒAsynchronous Module Definition(AMD)åº”è¿è€Œç”Ÿã€‚

> RequireJS æ–‡æ¡£ä¸­å…³äºä¸ºä»€ä¹ˆè¦ä½¿ç”¨ AMD çš„é˜è¿°ï¼š[Why AMD?](https://requirejs.org/docs/whyamd.html#amd)

```js
define(["exports"], function (exports) {
  "use strict";

  var add = function (a, b) {
    return a + b;
  };

  exports.add = add;

  Object.defineProperty(exports, "__esModule", { value: true });
});
```

ä»¥ä¸Šä»£ç æ˜¯`format`è¢«è®¾ç½®ä¸º`amd`æ—¶ï¼Œ`rollup`ç”Ÿæˆçš„ç›®æ ‡ä»£ç ã€‚

ç­‰ç­‰ï¼Œè¿™ä¸ª`define`å‡½æ•°æ˜¯ä»å“ªé‡Œå†’å‡ºæ¥çš„ï¼Œå®ƒåˆæœ‰ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ç”¨æˆ·ä¼šå¦‚ä½•ä½¿ç”¨è¿™ä¸ªåŒ…ã€‚

#### RequireJS

RequireJS æ˜¯ä¸€ä¸ªå¸®æˆ‘ä»¬åŠ è½½ amd æ¨¡å—çš„å·¥å…·ã€‚ä½¿ç”¨ RequireJS åŠ è½½æˆ‘ä»¬çš„åº“çš„ä»£ç å°†ç±»ä¼¼äºï¼š

```html
<!-- å¼•å…¥require.js -->
<script src="/js/require.js"></script>

<script>
  /**
   * å¯¹RequireJSè¿›è¡Œé…ç½®
   */
  requirejs.config({
    baseUrl: "js/lib",
    paths: {
      app: "../app",
    },
  });

  /**
   *åŠ è½½ js/lib/my-module.js ä¸­å®šä¹‰çš„æ¨¡å—
   */
  requirejs(["my-module"], function ($) {
    console.log($.add(1, 2)); // ä½¿ç”¨æ¨¡å—
  });
</script>
```

æŸ¥é˜…äº† RequireJS çš„[å®˜æ–¹æ–‡æ¡£](https://requirejs.org/docs/api.html)ï¼Œæˆ‘ä»¬å‘ç° RequireJS ä¸ºæˆ‘ä»¬æä¾›äº†åä¸º`requirejs`/`require`çš„ç”¨äºåŠ è½½æ¨¡å—çš„å‡½æ•°ã€‚å®ƒæ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç”±ä¾èµ–ç»„æˆçš„æ•°ç»„ã€‚RequireJS ä¼šæ ¹æ®æˆ‘ä»¬çš„é…ç½®ä»¥åŠæ¨¡å—çš„ idï¼Œç”Ÿæˆ JS æ–‡ä»¶çš„è·¯å¾„ï¼Œç„¶ååŠ è½½è¯¥æ–‡ä»¶ã€‚åœ¨æ‰€æœ‰ä¾èµ–åŠ è½½å®Œæˆåï¼ŒRequireJS å°†æ‰§è¡Œä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥çš„å›è°ƒå‡½æ•°ï¼Œå¹¶æŠŠå„ä¸ªæ¨¡å— export çš„å†…å®¹ä½œä¸ºå‚æ•°ä¾æ¬¡ä¼ å…¥ã€‚

ç»§ç»­é˜…è¯»æ–‡æ¡£ï¼Œæˆ‘ä»¬çŸ¥é“ RequireJS æä¾›äº†`define`ä»¥ä¾›æˆ‘ä»¬å®šä¹‰æ¨¡å—ã€‚`define`æ¥æ”¶çš„ç¬¬ä¸€ä¸ªå‚æ•°åŒæ ·ä¹Ÿæ˜¯ä¾èµ–æ•°ç»„ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯åŒ…å«æˆ‘ä»¬æ¨¡å—çš„ä»£ç çš„å‡½æ•°ã€‚RequireJS é¦–å…ˆè¦åŠ è½½ä¾èµ–çš„æ¨¡å—ã€‚ä¾èµ–è‡ªèº«å¯èƒ½åˆä¾èµ–äºå…¶ä»–æ¨¡å—ï¼Œæ‰€ä»¥ RequireJS ä¼šé‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼Œç›´åˆ°æ‰€æœ‰çš„ä¾èµ–éƒ½åŠ è½½å®Œæˆã€‚æ¥ç€ï¼ŒRequireJS ä¼šè°ƒç”¨æˆ‘ä»¬æä¾›çš„å‡½æ•°ï¼Œå¹¶ä¸”å°†ä¾èµ–çš„æ¨¡å— export çš„å†…å®¹ä½œä¸ºå‚æ•°ä¼ å…¥ã€‚

> RequireJS æ˜¯ä½¿ç”¨`head.appendChild()`åŠ è½½æ¨¡å—æ‰€åœ¨çš„ JS æ–‡ä»¶çš„ã€‚ç”±äºæ¨¡å—ä¹‹é—´å¯èƒ½ä¼šå½¢æˆå¤æ‚çš„ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥ RequireJS è¦ç¡®ä¿è¿™äº›æ¨¡å—ä»¥æ­£ç¡®çš„é¡ºåºæ‰§è¡Œã€‚

å†å›å¤´çœ‹ rollup ç”Ÿæˆçš„ä»£ç ï¼Œå¯ä»¥å‘ç°ç”Ÿæˆçš„æ¨¡å—ä¾èµ–äº†`exports`è¿™ä¸ªæ¨¡å—ã€‚äº‹å®ä¸Šï¼ŒRequireJS ä¸ºæˆ‘ä»¬æä¾›äº†ä¸‰ä¸ªâ€œMagic Moduleâ€ï¼Œåˆ†åˆ«æ˜¯`require`ã€`exports`å’Œ`module`ã€‚ä»–ä»¬å¹¶ä¸æ˜¯é€šå¸¸åœ¨ JS æ–‡ä»¶ä¸­å®šä¹‰çš„æ¨¡å—ï¼Œè€Œæ˜¯ä¸‰ä¸ªç‰¹æ®Šçš„æ¨¡å—ã€‚åœ¨`exports`ä¸Šæ–°å¢çš„å±æ€§å°†æˆä¸ºæ¨¡å—å…¬å…±æ¥å£çš„ä¸€éƒ¨åˆ†ã€‚ä¸‹é¢çš„ä»£ç ä¼šä¸ä¼šè®©ä½ è”æƒ³åˆ° CommonJS æ¨¡å—å‘¢ï¼Ÿ

```js
define(["require", "exports", "my-module"], function (require, exports) {
  "use strict";

  const $ = require("my-module");

  var add = function (a) {
    return function (b) {
      return $.add(a, b);
    };
  };

  exports.add = add;
});
```

ç”šè‡³ï¼ŒRequireJS è¿˜æä¾›äº†è¢«ç§°ä¸º simplified CommonJS Wrapper çš„è¯­æ³•ç³–ï¼š["Sugar" section in the Why AMD page](https://requirejs.org/docs/whyamd.html#sugar)ã€‚ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå°½ç®¡è¯¥è¯­æ³•ç³–æœ‰è¿™æ ·ä¸€ä¸ªåå­—ï¼Œè¿™ä¸æ„å‘³ç€å®ƒå’Œ CommonJS æ¨¡å—æ˜¯ 100%[å…¼å®¹](https://requirejs.org/docs/whyamd.html#commonjscompat)ã€‚

AMD ä¹Ÿä¸æ˜¯æ²¡æœ‰ç¼ºç‚¹çš„ã€‚å®ƒå¸¸è¢«äººè¯Ÿç—…çš„æ˜¯è¯­æ³•æ¯”è¾ƒç¹çï¼Œè‡³å°‘å’Œ CommonJS ç›¸æ¯”å¦‚æ­¤ã€‚æ¨¡å—çš„ä»£ç è¢«åŒ…è£¹åœ¨`define`è°ƒç”¨ä¹‹ä¸­ï¼Œå¢åŠ äº†ä¸€å±‚ç¼©è¿›ã€‚å¯¹äºå¤§å‹çš„æ¨¡å—æ¥è¯´ï¼Œè¿™å¯èƒ½ä¸å¤ªç†æƒ³ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œä¾èµ–æ•°ç»„ä¸­ä¾èµ–çš„é¡ºåºéœ€è¦å’Œå›è°ƒå‡½æ•°ä¸­å‚æ•°çš„é¡ºåºä¸€ä¸€å¯¹åº”ã€‚å½“ä¾èµ–è¿‡å¤šæ—¶ï¼Œè¿™ä¼šç»™æˆ‘ä»¬å¢åŠ éº»çƒ¦ã€‚å°½ç®¡å¦‚æ­¤ï¼ŒAMD è¿˜æ˜¯ä¸€ä¸ªéå¸¸ä¸é”™çš„ JavaScript æ¨¡å—è§£å†³æ–¹æ¡ˆã€‚

### Universal Module Definitionï¼ˆUMDï¼‰

ç°åœ¨ï¼Œæˆ‘ä»¬çŸ¥é“åœ¨ä¸åŒçš„å¹³å°ï¼Œåå¥½çš„æ¨¡å—å½¢å¼æ˜¯ä¸åŒçš„ã€‚é‚£æˆ‘ä»¬ç¼–å†™åº“çš„æ—¶å€™ï¼Œè¯¥é€‰æ‹©å“ªç§ä»¥å“ªç§æ¨¡å—å½¢å¼å‘å¸ƒå‘¢ï¼Ÿæˆ–è€…ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰€æœ‰çš„å¹³å°å¼€å‘è€…éƒ½å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„åº“ï¼Œæˆ‘ä»¬æ˜¯è¦å‘å¸ƒå¤šä¸ªä¸åŒçš„ç‰ˆæœ¬å—ï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬çš„æ•‘æ˜Ÿ UMD æ¥äº†ã€‚

```js
(function (global, factory) {
  typeof exports === "object" && typeof module !== "undefined"
    ? factory(exports)
    : typeof define === "function" && define.amd
    ? define(["exports"], factory)
    : ((global =
        typeof globalThis !== "undefined" ? globalThis : global || self),
      factory((global.$ = {})));
})(this, function (exports) {
  "use strict";

  var add = function (a, b) {
    return a + b;
  };

  exports.add = add;

  Object.defineProperty(exports, "__esModule", { value: true });
});
```

ä»¥ä¸Šä»£ç æ˜¯`format`è¢«è®¾ç½®ä¸º`umd`æ—¶ï¼Œ`rollup`ç”Ÿæˆçš„ç›®æ ‡ä»£ç ã€‚

åŸæ¥ï¼ŒUMD å°±æ˜¯ä¸€ç³»åˆ—ç”¨äºåˆ¤æ–­å½“å‰ç¯å¢ƒæ”¯æŒä»€ä¹ˆæ ·çš„æ¨¡å—å½¢å¼çš„`if`/`else`è¯­å¥ã€‚æ‰“å¼€`1.11.3`ç‰ˆæœ¬çš„ jQuery çš„æºç ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç° jQuery æ­£æ˜¯ä½¿ç”¨äº†è¿™ç§å½¢å¼çš„æ¨¡å—ã€‚

### ECMAScript æ¨¡å—

ECMAScript 2015 æ˜¯è¿‘äº›å¹´æœ€ä¸ºé‡è¦çš„ä¸€ä¸ª ECMAScript ç‰ˆæœ¬ï¼Œå®ƒä¸º JS å¢åŠ äº†éå¸¸å¤šçš„ featuresï¼Œæ¯”å¦‚ç®­å¤´å‡½æ•°ã€`let`/`const`å˜é‡ç­‰ã€‚è€Œ ECMAScript æ¨¡å—æ˜¯å…¶ä¸­çš„é‡é‡çº§ feature ä¹‹ä¸€ã€‚ä¸è¿‡å‰ç«¯å¼€å‘è€…éƒ½æ˜ç™½ï¼Œç†æƒ³å’Œç°å®å¾€å¾€æ˜¯æœ‰å·®è·çš„ã€‚æ¯”å¦‚åœ¨ ES5 æ—¶ä»£ï¼Œå¦‚æœæ‰€æœ‰çš„æµè§ˆå™¨éƒ½èƒ½å®Œå…¨æŒ‰ç…§ ECMAScript specs å®ç°ï¼Œé‚£ä¹ˆå‰ç«¯å¼€å‘è€…å°±ä¸éœ€è¦äº†è§£é‚£ä¹ˆå¤šä¸æµè§ˆå™¨å…¼å®¹æ€§ç›¸å…³çš„ hacksï¼Œå·¥ä½œå°±èƒ½è½»æ¾å¾ˆå¤šã€‚ECMAScript 2015 å½“ç„¶ä¹Ÿé¢ä¸´ç€åŒæ ·çš„å›°å¢ƒã€‚ä» caniuse ç½‘ç«™ä¸Šå¯ä»¥çœ‹åˆ°ï¼ŒåŸç”Ÿæ”¯æŒ ES æ¨¡å—çš„æµè§ˆå™¨ç›´åˆ° 2017 å¹´æ‰æ…¢æ…¢å¼€å§‹å‡ºç°ã€‚å³ä½¿åˆ°äº†ä»Šå¤©ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜æ˜¯æ— æ³•ç›´æ¥å‘å¸ƒä½¿ç”¨äº† ES æ¨¡å— çš„ web appã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦è‹¦è‹¦ç­‰å¾…æµè§ˆå™¨å‚å•†æ›´æ–°ä»–ä»¬çš„äº§å“ã€‚ç°ä»£åŒ–å‰ç«¯å¼€å‘æ—¶ä»£é€ å°±å·²ç»æ¥ä¸´ã€‚è€Œè¿™ä¸€åˆ‡éƒ½è¦æ„Ÿè°¢ babelã€webpack ä»¥åŠ TypeScript ç­‰å·¥å…·çš„å‡ºç°ã€‚

babel æ˜¯ä¸€ä¸ª JavaScript çš„ç¼–è¯‘å™¨ï¼Œèƒ½å¤Ÿå°†åŒ…å«æ–° ECMAScript è¯­è¨€ç‰¹æ€§çš„ JS ä»£ç è½¬åŒ–æˆä¸ºå…¼å®¹æ€§æ›´å¥½çš„ç›®æ ‡ä»£ç ã€‚è€Œä¸” babel èƒ½åšçš„è¿œè¿œä¸æ­¢è¿™äº›ã€‚é€šè¿‡ç¼–å†™æ’ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º babel å¢åŠ å¯¹ ECMAScript æ ‡å‡†ä¹‹å¤–çš„ç‰¹æ€§çš„æ”¯æŒã€‚è¿™æ„å‘³ç€å¼€å‘è€…å¯ä»¥åšä¸€äº›å¾ˆæœ‰æ„æ€å¾ˆé…·çš„äº‹ï¼Œæ¯”å¦‚è®¾è®¡ä¸€ä¸ªåƒ JSX è¯­æ³•é‚£æ ·åµŒå…¥äº JS ä¸­çš„ DSLã€‚

æœ‰äº†è¿™äº›å·¥å…·ï¼Œå‰ç«¯å¼€å‘è€…ä»¬é€æ¸ä¹ æƒ¯äºä½¿ç”¨ ES æ¨¡å—ã€‚è€Œå…³äºå…¶è¯­æ³•ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶éƒ½å·²ç»ç†Ÿç¨”äºå¿ƒäº†ï¼Œåœ¨æ­¤å¤„ä¸å†ä½œå±•å¼€ã€‚

## ç°ä»£ JavaScript åº“çš„å¼€å‘

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›åˆ°æœ€å¼€å§‹çš„è¯é¢˜ â€”â€”â€”â€” æˆ‘ä»¬åº”è¯¥å¦‚ä½•å‘å¸ƒæˆ‘ä»¬çš„åº“ã€‚è€Œä¸”æˆ‘ä»¬åˆå¢åŠ äº†ä¸€ä¸ªè®¨è®ºçš„å‰æï¼Œé‚£å°±æ˜¯è¿™ä¸ªåº“çš„æºä»£ç ä½¿ç”¨çš„æ˜¯ ES æ¨¡å—ï¼Œå› ä¸ºæˆ‘ä»¬å¼€å‘æ—¶å·²ç»ç¦»ä¸å¼€å®ƒäº†ã€‚ä¸ºäº†è®©å°½å¯èƒ½å¤šçš„ç”¨æˆ·èƒ½å¤Ÿä½¿ç”¨æˆ‘ä»¬çš„åº“ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®ç”¨æˆ·çš„ä½¿ç”¨æ–¹å¼æä¾›ä¸åŒç‰ˆæœ¬çš„åº“ã€‚

> ç”±äºæœ‰äº† rollup ç­‰å·¥å…·çš„å¸®åŠ©ï¼Œç”Ÿæˆå¤šä¸ªç‰ˆæœ¬ä»£ç æˆä¸ºäº†å‘å¸ƒåº“æ—¶çš„ä¸»æµåšæ³•ã€‚

### é€šè¿‡ `<script>` å¼•å…¥

å¦‚æœæˆ‘ä»¬å…è®¸ç”¨æˆ·èƒ½å¤Ÿç›´æ¥é€šè¿‡`<script>`æ ‡ç­¾å¼•å…¥åº“ï¼Œé‚£ä¹ˆæˆ‘ä»¬åº”è¯¥è¾“å‡ºä¸€ä»½ä½¿ç”¨ UMD çš„ç‰ˆæœ¬ä»¥ä¾›ç”¨æˆ·ä¸‹è½½ä½¿ç”¨ã€‚

### åœ¨ NodeJS ä¸­å¼•å…¥

NodeJS åŒæ—¶æ”¯æŒ CommonJS æ¨¡å—å’Œ ECMAScript æ¨¡å—ã€‚CommonJS æ¨¡å—æ–‡ä»¶åç¼€åä¸º`.cjs`ï¼Œè€Œ ES æ¨¡å—æ–‡ä»¶åç¼€åä¸º`.mjs`ã€‚è€Œä»¥`.js`ç»“å°¾çš„æ–‡ä»¶ä¼šè¢« NodeJS å½“ä½œå“ªç§æ¨¡å—åŠ è½½åˆ™å–å†³äº`package.json`çš„`type`é¡¹ã€‚å½“`type`æœªè®¾ç½®æˆ–è€…å€¼ä¸º`commonjs`æ—¶ï¼Œ`.js`æ–‡ä»¶è¢«å½“ä½œåŒ…å« CommonJS æ¨¡å—çš„æ–‡ä»¶ï¼›å½“`type`çš„å€¼ä¸º`module`æ—¶ï¼Œ`.js`æ–‡ä»¶è¢«å½“ä½œåŒ…å« ES æ¨¡å—çš„æ–‡ä»¶ã€‚

è¿™é‡Œæœ‰ä¸€ä¸ªå°é—®é¢˜éœ€è¦ç•™æ„ã€‚NodeJS æœ‰ä¸¤ç§ modules loaderã€‚ES module loader æ˜¯å¼‚æ­¥çš„ï¼Œè´Ÿè´£å¤„ç†`import`è¯­å¥å’Œ`import()`è¡¨è¾¾å¼ã€‚å®ƒä¸ä»…èƒ½å¤ŸåŠ è½½ ES æ¨¡å—ï¼Œä¹Ÿå¯ä»¥åŠ è½½ CommonJS æ¨¡å—ã€‚è€Œ CommonJS module loader æ˜¯åŒæ­¥çš„ï¼Œè´Ÿè´£å¤„ç†`require`è°ƒç”¨ã€‚ä½†å› ä¸ºåŒæ­¥è¿™ä¸€æ€§è´¨ï¼Œå®ƒä»…èƒ½åŠ è½½ CommonJS æ¨¡å—ã€‚è¿™å°±å¯¼è‡´äº†å½“æˆ‘ä»¬å°†`package.json`çš„`main`é¡¹æŒ‡å‘ä¸€ä¸ª ES æ¨¡å—æ–‡ä»¶ï¼Œç”¨æˆ·å°±æ— æ³•ç›´æ¥ä½¿ç”¨`require`å¼•å…¥è¿™ä¸ªåŒ…ã€‚ï¼ˆå¦‚æœæƒ³åœ¨ CommonJS æ¨¡å—ä¸­å¼•å…¥ ES æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨`import()`è¡¨è¾¾å¼ã€‚ï¼‰

> è¡¥å……ä¸€äº›å…³äº`import`ã€`import()`å’Œ`require()`çš„ä¿¡æ¯
>
> 1. `import React from "react";`æ˜¯è¯­å¥ï¼ˆStatementï¼‰ï¼Œæ­£å¦‚`if (cond) {} else {}`ã€‚`import`è¯­å¥ä¸­`from`ä¹‹ååªèƒ½è·Ÿå­—ç¬¦ä¸²å­—é¢é‡ã€‚
> 2. `import('react')`æ˜¯è¡¨è¾¾å¼ï¼ˆExpressionï¼‰ï¼Œæ­£å¦‚`cond ? foo : bar`ã€‚è¿™é‡Œçš„`import`æ˜¯å…³é”®å­—è€Œä¸æ˜¯å‡½æ•°ã€‚`import()`è¡¨è¾¾å¼ä¸­çš„å¯ä»¥æ˜¯ AssignmentExpressionã€‚æ‰€ä»¥ä»¥ä¸‹ä»£ç æ˜¯ç¬¦åˆè¯­æ³•çš„ï¼š
>
>    ```js
>    const module = "react";
>    const React = await import(module);
>    ```
>
> 3. `require(id)`æ˜¯å‡½æ•°è°ƒç”¨ã€‚

è¿˜å¥½ï¼ŒNodeJS æ³¨æ„åˆ°äº†`main`çš„å±€é™æ€§ï¼Œå¹¶æ–°å¢äº†ä¸€ç§åœ¨`package.json`ä¸­å®šä¹‰å…¥å£æ–‡ä»¶çš„æ–¹æ³• â€”â€”â€”â€” ä½¿ç”¨`exports`é¡¹ã€‚å¯¹äºæ”¯æŒ`exports`çš„ NodeJS ç‰ˆæœ¬è€Œè¨€ï¼Œå…¶ä¼˜å…ˆçº§é«˜äº`main`é¡¹ã€‚`exports` è¡¥è¶³äº† `main` åªå¯ä»¥æŒ‡å®šä¸€ä¸ªä¸»å…¥å£æ–‡ä»¶çš„ç¼ºç‚¹ï¼Œå¹¶å¢åŠ äº†æ ¹æ®ç¯å¢ƒçš„ä¸åŒè§£æåˆ°ä¸åŒå…¥å£æ–‡ä»¶çš„èƒ½åŠ›ï¼ˆconditional exportsï¼‰ï¼Œå¹¶ä¸”é˜»æ­¢äº†ç”¨æˆ·è®¿é—®æœªå®šä¹‰çš„å…¥å£æ–‡ä»¶ã€‚åˆ©ç”¨ `exports`ï¼Œ æˆ‘ä»¬å¯ä»¥æä¾›å¤šç§ç‰ˆæœ¬çš„æ–‡ä»¶ï¼Œä¾› NodeJS æ ¹æ®æƒ…å†µè¿›è¡Œé€‰æ‹©ã€‚ä¸€ä¸ªä½¿ç”¨`exports`çš„ä¾‹å­ï¼š

```json
// package.json
{
  "exports": {
    "import": "./index-module.js",
    "require": "./index-require.cjs"
  },
  "type": "module"
}
```

> The "exports" provides a modern alternative to "main" allowing multiple entry points to be defined, conditional entry resolution support between environments, and preventing any other entry points besides those defined in "exports".
>
> â€”â€” NodeJS å®˜æ–¹æ–‡æ¡£

`exports` è®©åŒ…ä½œè€…æœ‰äº†ä¸€å®šæ§åˆ¶ NodeJS å¦‚ä½•è§£æåŒ…ä¸­æ¨¡å—è·¯å¾„çš„èƒ½åŠ›ã€‚NodeJS è¿˜å¢åŠ äº†`imports`é¡¹ï¼Œè¿›ä¸€æ­¥æ–¹ä¾¿äº†åŒ…ä½œè€…ã€‚ä¸è¿‡è¿™ä¸æœ¬æ–‡çš„ä¸»é¢˜å…³ç³»ä¸å¤§ï¼Œå› æ­¤ä¸ä½œè¿‡å¤šä»‹ç»ã€‚åªæ˜¯ï¼Œè¦æé†’çš„ä¸€ç‚¹æ˜¯ï¼Œbundler æœªå¿…æ”¯æŒè¿™äº› NodeJS çš„æ–°ç‰¹æ€§ã€‚å› æ­¤ï¼Œ`imports`é¡¹çš„ä½¿ç”¨å¯èƒ½ä¼šå¯¼è‡´ bundler æ‰¾ä¸åˆ°æ¨¡å—çš„é—®é¢˜ã€‚

### bundler

å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¼•å…¥åº“çš„å·¥ä½œå…¶å®æ˜¯äº¤ç»™äº† webpack ä¹‹ç±»çš„ bundler å¤„ç†ã€‚ç”±äº bundler æœ‰ç›´æ¥å¤„ç† ES æ¨¡å—çš„èƒ½åŠ›ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å‡ºä¸€ä»½ä¿ç•™ ES æ¨¡å—çš„ç‰ˆæœ¬ã€‚å¹¶ä¸”ï¼Œå°†`package.json`çš„`module`è®¾ç½®ä¸º ESM ç‰ˆæœ¬æ–‡ä»¶çš„è·¯å¾„ã€‚

> ES modules ä¼˜äº CJS modules çš„æ˜¯å‰è€…å¯¹äº tree shaking æˆ–è€… dead code removal æ›´å‹å¥½ã€‚

## å®ä¾‹

ç›®å‰æ¯”è¾ƒé€‚åˆç”¨æ¥åº“å¼€å‘æ—¶ä½¿ç”¨çš„ bundler æœ‰ rollup å’Œ esbuildã€‚esbuild çš„ä¼˜åŠ¿åœ¨äºå…¶ build çš„é€Ÿåº¦éå¸¸å¿«ï¼Œrollup çš„ä¼˜åŠ¿åœ¨äºä¾¿æ·çš„é…ç½®ã€ä¼˜ç§€çš„æ’ä»¶æœºåˆ¶ä»¥åŠä¸°å¯Œçš„ç¤¾åŒºç”Ÿæ€ç­‰ã€‚ä¸€ä¸ªä½¿ç”¨ rollup æ‰“åŒ…çš„ä¾‹å­ï¼š [modern-library-template](https://github.com/panchao5/modern-library-template)ã€‚

## æ‹“å±•ï¼šä¸ºä»€ä¹ˆä¸åº”è¯¥ä½¿ç”¨`export default`

åº“ä½œè€…ä»¬åº”è¯¥å°½é‡é¿å…`export default`çš„ä½¿ç”¨ã€‚é¦–å…ˆï¼Œ`export default`åªæ˜¯è¯­æ³•ç³–ï¼Œå¹¶ä¸æ˜¯å¼€å‘æ‰€å¿…é¡»çš„ã€‚

```js
export default function () {}
```

ä¸

```js
function _default_() {}

export { _default_ as default };
```

æ˜¯ç­‰ä»·çš„ã€‚

> è¿™é‡Œçš„`_default_`åªèµ·ç¤ºæ„çš„ä½œç”¨ï¼Œå¹¶ä¸æ„å‘³ç€çœŸçš„å­˜åœ¨è¿™ä¸ªå˜é‡ã€‚

å…¶æ¬¡ï¼Œ`export default`ä¼šå¯¼è‡´é¡¹ç›®ä¸­å˜é‡å‘½åçš„æ··ä¹±ã€‚æœ€åä¹Ÿæ˜¯æœ€ä¸ºå…³é”®çš„ä¸€ç‚¹ï¼Œ`export deafult` å¯¼è‡´çš„ä¸ CommonJS module ä¹‹é—´çš„å…¼å®¹æ€§é—®é¢˜ã€‚

å‡å¦‚æœ‰å¦‚ä¸‹æºæ–‡ä»¶ï¼š

```js
// hello.js

export default "foo";
```

å¤§å¤šæ•° bundler è¾“å‡ºçš„ç»“æœä¼šç±»ä¼¼äºï¼š

```js
"use strict";

Object.defineProperty(exports, "__esModule", { value: true });

var hello = "hello";

exports["default"] = hello;
```

è¿™ä¼šå¯¼è‡´ï¼š

1. åœ¨ CJS æ¨¡å—ä¸­ï¼Œç”¨æˆ·éœ€è¦ä½¿ç”¨ `require('my-module').default` æ¥è®¿é—®æˆ‘ä»¬ export çš„å†…å®¹ã€‚è¿™ä¼šç»™ç”¨æˆ·é€ æˆä½¿ç”¨ä¸Šçš„ä¸ä¾¿ã€‚
2. åœ¨ ESM æ¨¡å—ä¸­ï¼Œç”¨æˆ·ä½¿ç”¨`import foo from 'my-module'`æ¥è®¿é—®æˆ‘ä»¬çš„åº“ã€‚ä½†é—®é¢˜åœ¨äºï¼Œ`foo`çš„å€¼åº”è¯¥æ˜¯ï¼Ÿå¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œesbuild ä½œè€…åœ¨[æ–‡æ¡£ä¸­](https://esbuild.github.io/content-types/#default-interop)æœ‰è¿‡æ¯”è¾ƒè¯¦ç»†çš„æè¿°ã€‚ç”±äº bundler å’Œ Nodejs çš„å¤„ç†å¯èƒ½ä¸åŒï¼Œæ‰€ä»¥å°½é‡è¿˜æ˜¯ä¸è¦ä½¿ç”¨`export default`ã€‚


